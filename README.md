SPAM DETECTOR using PY SPARK
=========================

A model created in PySpark to classify mails as spam or not spam.
This project was meant to verify the compatibility of models between Pyspark and Java-Spark.
The models are saved in the directory `data/sparkmodel`

The related project in Java Spark is here: http://github.com/diegoami/DA_spamdetector_javaspark


## SET UP

In a Python environment, install Pyspark and numpy 

## RUN locally

To create the model and export it to `data/sparkmodel`, execute the command

```
python create_model.py
```

This model is the same generated by http://github.com/diegoami/DA_spamdetector_javaspark

To test it

```
python test_model.py
```

## EXECUTE IN DOCKER

YOUR_DATA_DIRECTORY is where you put the model files

Build the docker image

```
docker build -t spam_detector_pyspark . 
```

Create the model
```
docker run  -v <YOUR_DATA_DIRECTORY>:/opt/data spam_detector_pyspark /bin/sh -c "python create_model.py"
```

test the model
```
docker run  -v <YOUR_DATA_DIRECTORY>:/opt/data spam_detector_pyspark /bin/sh -c "python test_model.py"
```

## EXPECTED MODEL PERFORMANCE

Test PR and ROC : 0.8782117128454908, 0.9024385488801547                        

Overall PR and ROC : 0.9781629515801471, 0.9820789201711856

Confusion matrix : 
[[4820.,    5.],
 [  26.,  721.]]
 
 See [model.out](model.out) for more metrics.
